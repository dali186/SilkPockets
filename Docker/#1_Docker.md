# Docker

### What is Docker?
__데이터 또는 프로그램을 격리시키는 기능__
- 개인용 컴퓨터나 서버에는 여러 가지 프로그램이 동시에 돌아감 
- 도커는 데이터나 프로그램을 독립된 환경에 격리하는 기능을 제공

체육관에 프로세스들이 이리저리 돌아다니는데,          
도커를 구축해서 각각 방을 만들어 놓는다          
이것을 컨테이너라고 칭하고          
컨테이너를 다루는 기능을 제공하는 소프트웨어가 도커다          

컨테이너를 만들기 위해서는 이미지가 필요함          
    - Linux 이미지랑 같은 개념인가?

일단 리눅스가 필요함. 윈도우나 mac에서도 도커가 돌아가지만, 내부적으로는 리눅스가 사용됨          
          
자 그럼 도커를 사용하는 이유는 뭘까?          
왜 굳이 잘 돌아다니는 애들을 방으로 나눌까?          
          
예를 들어보자, 시스템 A는 mySql 5.0 버전과 아파치 2.0을 사용한다.          
그리고 시스템 B는 mySql 8.0 버전과 아파치 2.4 버전을 사용한다.          
만약 A, B 시스템이 꼭 PC에서 구동이 되어야 하고           
아파치 2.4버전이 mySql 8.0 버전만 호환이 가능하다고 한다면          
해당 PC에서는 시스템 A와 B 둘 다 구동을 시킬 수 없을 것이다.          
그럴때 컨테이너 1 과 컨테이너 2로 나누어서          
컨테이너 1에는 mySql 5.0버전과 아파치 2.0 버전을 설치해서 격리시키고          
컨테이너 2에는 mySql 8.0버전과 아파치 2.4 버전을 설치해서 격리시키면          
해당 PC에서 시스템 A, B 둘 다 구동시킬 수가 있게 된다.          
          
쉽게 옮길 수 있음          
    도커엔진을 똑같은 상태로 튜닝을 한다면, 각각의 PC의 운영체제가 달라도 똑같이 사용할 수 있다 -> 물리적 환경의 차이, 서버 구성의 차이를 무시할 수 있음          

          
여기서 드는 의문은 VirtualBox같은 가상머신으로 나누는 것과 Docker로 나누는 것은 어떤 차이가 있는가          
VirtualBox는 메인보드, CPU, 메모리 등의 물리적인 부분을 소프트웨어로 대체해서 구현한다.          
그렇기 때문에 운영체제를 어떤걸 써도 사용이 가능하지만,          
Docker는 운영체제의 일부 기능을 호스트 컴퓨터에 의존하기 때문에 서버에도 리눅스 기능이 필요하며, 컨테이너도 리눅스 기반이 된다.          
          
[운영체제] - [Docker 엔진]  - [컨테이너]          
          
__컨테이너 안에는 운영체제 비스무리한 것들이 들어있다__          
          

운영체제가 하는 일          
소프트웨어[밥먹어라] -> 하드웨어[???]          
소프트웨어[밥먹어라] -> 운영체제[밥상 위에 위치한 밥을 숟가락을 들고 퍼서 먹어라] -> 하드웨어[got it]          
          
[운영체제] - [Docker 엔진]  - [컨테이너[운영체제 비스무리한 것]]          
[운영체제 비스무리한 것] -> 커널은 제외되어 있기 때문 ==> 결국에는 컨테이너는 호스트의 운영체제 커널을 사용한다는 말이지          
          
이미지는 컨테이너를 만드는 데 사용하는 것으로, 거푸집이라고 볼 수 있다. -> 똑같은 컨테이너를 계속 찍어낼 수 있거든          
역도 가능하다          
컨테이너로 이미지 만들기,          
이미지로 부터 컨테이너를 만들고 -> 컨테이너를 개조해서 -> 컨테이너로부터 이미지를 만들 수 있다.          
아반떼 이미지로 아반떼를 만들고 아반떼에 마후라 박아놓고 아반떼에 마후라 박아놓은 이미지를 만드는 느낌?          
          
도커엔진만 준비되어 있다면 다른 물리 서버에 컨테이너를 옮겨서 실행이 가능하다          
          
이미지는 hub.docker.com에서 구할 수 있다.          
운영체제만 들어있는 이미지 부터 여러 소프트웨어가 들어있는 이미지까지 다양한 이미지가 있다.          
무인 아이스크림 가게에서 원하는 아이스크림을 집어놓은 느낌이다.          
아무튼 이제 이미지가 어떤 건지 느낌이 잡힌다.          
같은 소프트웨어가 들어있다고 해도, 한 컨테이너에 싹 다 집어넣은 것도 있고, 하나의 컨테이너에 하나의 소프트웨어를 집어넣은 것들도 있다.          
          
도커의 생명주기는 어떻게 될까          
생성 -> 실행 -> 종료 -> 폐기 (일회용품)          
그러니까 종료되는 순간 바로 은퇴라는 소리다.          
개처럼 일했는데 은퇴라니 잔인하지만 어쩔 수 없다.          
새로운 버전이 개발이되면 해당 컨테이너에 있는 소프트웨어를 업데이트 시키기 보다는          
그냥 새로운 버전이 들어있는 이미지로 컨테이너를 생성하는게 더 쉽기 때문이다. (컨테이너는 생성이 쉽기 때문)          
          
억 그럼 은퇴한놈이 가지고 있던 데이터는 어떡하지          
그래서 데이터는 호스트 서버의 디스크에 마운트해 서버 디스크에 데이터를 저장한다.          
          
정리하면, 노트북(컨테이너라고 한다면)으로 작업을 하는데 작업 내용은 외장 하드에 저장하면서 작업을 한다.          
그러다가 노트북 안 소프트웨어가 새로운 버전이 생기면, 업데이트를 진행하는게 아니라          
노트북을 갖다 버리고 새로운 버전의 소프트웨어를 가지고 있는 노트북을 사용한다. 거따가 외장하드도 다시 꽂고          
          
          
말이 길었지만 총 정리를 해보면          
Docker는 독립된 환경을 제공한다. -> 여러 개의 컨테이너를 띄울 수 있다. -> 시스템 A, B를 동시에 띄울 수 있다 (위에서 말한 mySql과 Apache서버 예시 처럼)          
Docker는 이미지를 만들 수 있다. -> 똑같은 컨테이너를 쉽게 만들 수 있다. -> 개발환경을 구축하기 쉽다.          
Docker의 컨테이너에 커널이 없다 -> 가볍다 -> VirturalBox에 비하면 가볍다(요놈은 하드웨어를 소프트웨어로 재현함).          
단점은?          
Docker는 Linux용 소프트웨어밖에 지원하지 않는다.          
Docker의 컨테이너는 호스트 서버(물리 서버)에 문제가 생기면 영향을 받는다.          
그래서 어따 쓰냐 이거          
Docker는 동일한 개발환경을 제공하기 위해 사용된다.          
    - 도커 이미지를 만들어서 배포하면 도커 엔진이 있다면 이동이 가능하기 때문          
Docker는 새로운 버전의 테스트를 할 때 사용된다.          
    - 독립적이잖아. 상성을 고려안해도 된다.          
Docker는 동일한 서버가 여러 대 필요한 경우 사용한다.          
    - 물리 서버 비용 절약 가능, 명령을 각각 내릴 필요가 없다.          
          